import{a as ve}from"https://st-p.rmcdn.net/670469db/dist/c/c-MA7L3SLY.js";import{a as K}from"https://st-p.rmcdn.net/670469db/dist/c/c-YDV5G2MG.js";import{g as A,h as he}from"https://st-p.rmcdn.net/670469db/dist/c/c-RLWM66CD.js";import{a as B,b as Pe}from"https://st-p.rmcdn.net/670469db/dist/c/c-7Y3GM5K2.js";import{h as X,j as fe}from"https://st-p.rmcdn.net/670469db/dist/c/c-5B2NS3FD.js";import{b as _,c as N}from"https://st-p.rmcdn.net/670469db/dist/c/c-MW4WID2L.js";import{a as M,b as de}from"https://st-p.rmcdn.net/670469db/dist/c/c-OPGRMSYA.js";import{h as F,v as ue}from"https://st-p.rmcdn.net/670469db/dist/c/c-HSON2DYX.js";import{a as J,b as ye}from"https://st-p.rmcdn.net/670469db/dist/c/c-TS5SXMOU.js";import{a as D,b as G,k as be}from"https://st-p.rmcdn.net/670469db/dist/c/c-5WATQWGQ.js";import{a as b,b as j}from"https://st-p.rmcdn.net/670469db/dist/c/c-TVTF4FMR.js";import{a as R,b as I,e as me}from"https://st-p.rmcdn.net/670469db/dist/c/c-TZA2GAIN.js";import{d as Y,e as pe}from"https://st-p.rmcdn.net/670469db/dist/c/c-L62NKE2T.js";import{a as h,d as ce}from"https://st-p.rmcdn.net/670469db/dist/c/c-J4NXJMTF.js";import{C as l,D as T,E as C}from"https://st-p.rmcdn.net/670469db/dist/c/c-KPCMO4IS.js";import{a as $}from"https://st-p.rmcdn.net/670469db/dist/c/c-3G26G4UH.js";import{b as k,c as ae}from"https://st-p.rmcdn.net/670469db/dist/c/c-LSFXDQU7.js";import{a as x,c as le}from"https://st-p.rmcdn.net/670469db/dist/c/c-4RRFSRAU.js";import{d as E,f as v}from"https://st-p.rmcdn.net/670469db/dist/c/c-43CRZFF7.js";j();be();ye();le();var Z=E(ve()),i=E($());ue();ae();var V=E($());de();fe();pe();me();j();C();function Ce({slideshowBox:e,transform:n,zoom:a,pageX:p,pageY:r}){let s=M.mapElementToViewport(e,n,a),o={left:p,top:r};if(M.isPointInBox(o,s)){let d={left:o.left-s.left,top:o.top-s.top},t=d.left<=s.width/2?"left":"right";return{cursorPositionInElement:d,side:t}}return null}function Q({isMobile:e,children:n}){let a=(0,V.useRef)(null),p=X(u=>u.meta.state),{zoom:r,transform:s}=p,{isRenderedOnClient:o}=Y(),[{top:d,left:t,isVisible:c},P]=(0,V.useState)({top:0,left:0,side:"left",isVisible:!1});K(({x:u,y:S})=>{if(a.current){let m=Ce({slideshowBox:a.current,transform:s,zoom:r,pageX:u,pageY:S});m?P({...m.cursorPositionInElement,side:m.side,isVisible:!0}):c&&P({top:0,left:0,side:"left",isVisible:!1})}},[a,r,s,c,o]);let f=(0,V.useMemo)(()=>({display:c?"block":"none",transform:`translate(${R`calc(${I(t)} / ${u=>u.pageScale})`}, ${R`calc(${I(d)} / ${u=>u.pageScale})`})`}),[c,t,d]);return e?null:l(b,{ref:a,width:"100%",height:"100%",position:"absolute",top:0,left:0,cursor:"none",overflow:"auto",children:o?l(b,{position:"absolute",style:f,children:n}):null})}he();Pe();ce();N();C();var Ve=D(b);function w({widget:e,isVisible:n=!1,isTabVisible:a,playerRef:p}){let r=e.provider_name==="File"?`${k.readymag_video_files_bucket}/${e.url}`:e.url,s=e.custom_controls?.playbackType,o=e.controls&&e.controls_type==="custom",d=e.url&&B.isYoutube(r)?B.getYoutubeIdFromUrl(e.url):"",[t]=(0,i.useState)(()=>new W),{isPlaying:c}=t.useSnapshot(),[P,f]=(0,i.useState)(!1),[u,S]=(0,i.useState)();(0,i.useImperativeHandle)(p,()=>t,[t]),(0,i.useEffect)(()=>{e.autoplay&&a&&t.play()},[]);let{isCustomThumbnail:m,thumbnail:oe}=(0,i.useMemo)(()=>e.picture&&e.custom_thumbnail?{isCustomThumbnail:!0,thumbnail:e.picture}:{isCustomThumbnail:!1,thumbnail:{url:`${k.readymag_video_files_bucket}/${e.thumbnail_url}`,type:"jpg"}},[e.picture,e.thumbnail_url,e.custom_thumbnail]),[O,te]=(0,i.useState)(!1),re=(0,i.useMemo)(()=>P?m?e.autoplay?!1:!O:!1:!0,[m,P,O,e.autoplay]);function se(){te(!0),q()}let L=(0,i.useCallback)(()=>{t.play(),t.events.dispatchEvent(new CustomEvent("start",{detail:`${e.title} / ${r}`}))},[r,e.title,t]),z=(0,i.useCallback)(()=>{t.stop(),t.events.dispatchEvent(new CustomEvent("stop",{detail:`${e.title} / ${r}`}))},[r,e.title,t]);function q(){t.play()}function ie(){t.stop()}function g(){c?ie():q()}function ne(){return o&&e?.custom_controls?.floating?l(Q,{children:l(A,{isPlaying:c,dataModel:e,inViewer:!0,progress:u?.played&&u.played*100,onClick:g})}):l(A,{isPlaying:c,dataModel:e,inViewer:!0,progress:u?.played&&u.played*100,onClick:g})}let H=Ee(e);return T(b,{position:"relative",width:"100%",height:"100%",onMouseOver:()=>s==="Hover"&&!o&&L(),onMouseLeave:()=>s==="Hover"&&!o&&z(),onClick:()=>s==="Click"&&!o&&g(),children:[l(G,{children:re&&T(Ve,{width:"100%",height:"100%",position:"absolute",top:0,left:0,zIndex:10,pointerEvents:"all",objectFit:"cover",style:H,initial:{opacity:1},animate:{opacity:1},exit:{opacity:0},role:m?"button":void 0,cursor:m?"pointer":void 0,onClick:m?se:void 0,children:[m&&l(b,{position:"absolute",top:"50%",left:"50%",zIndex:10,transform:"translate(-50%, -50%)",children:l(J,{width:65,height:65,color:"white"})}),l(b,{"data-testid":"poster",display:n?"block":"none",backgroundImage:`url(${oe.url})`,backgroundSize:"cover",pointerEvents:"none"})]})}),!x()&&l(Z.default,{width:e.w,height:e.h,url:r,muted:e.mute||!o,loop:e.loop,onReady:()=>{f(!0)},onPlay:L,onPause:z,playing:c,controls:e.controls&&e.controls_type==="default",onProgress:U=>S(U),playsinline:e.autoplay,style:{pointerEvents:o?"none":"all",...H},config:{youtube:{playerVars:{wmode:"opaque",enablejsapi:1,autohide:1,showinfo:e.info,theme:e.theme,html5:1,rel:0,vq:"hd1080"},embedOptions:{videoId:d}},vimeo:{playerOptions:{wmode:"opaque",api:1,title:e.info,byline:e.info,portrait:e.info,color:e.color,autoplay:0,controls:1}}}}),!x()&&o&&ne()]})}function Ee(e){if(e.video_styles){let{color:n,borders:a,opacity:p,radius:r,radius_rect_tl:s,radius_rect_tr:o,radius_rect_br:d,radius_rect_bl:t,radius_rect_independent:c,video_opacity:P}=e.video_styles,f=F(n,p);return{display:"grid",borderRadius:c?`${h(s)} ${h(o)} ${h(d)} ${h(t)}`:h(r),borderColor:`rgba(${f.r}, ${f.g}, ${f.b}, ${f.a})`,borderStyle:"solid",borderWidth:h(a),opacity:P/100,overflow:"hidden",boxSizing:"border-box",position:"relative"}}}var W=class extends _{constructor(){super();v(this,"events");v(this,"isPlaying",!1);this.events=this.detach(new EventTarget)}play(){this.isPlaying=!0}stop(){this.isPlaying=!1}};var y=E($());N();C();var ee=class extends _{constructor(){super(...arguments);v(this,"player");v(this,"isStarted")}};function Ze({widget:e,analytics:n,sharedState:a}){let p=(0,y.useRef)(),r=(0,y.useCallback)(o=>{o instanceof CustomEvent&&n?.sendEvent("video_start",o.detail)},[n]),s=(0,y.useCallback)(o=>{o instanceof CustomEvent&&n?.sendEvent("video_complete",o.detail)},[n]);return(0,y.useEffect)(()=>{let o=p.current?.events;return o&&o.addEventListener("start",r),o&&o.addEventListener("stop",s),()=>{o&&o.removeEventListener("start",r),o&&o.removeEventListener("stop",s)}},[s,r]),(0,y.useEffect)(()=>{a.player=p.current}),l(w,{widget:e,isTabVisible:a.isStarted,isVisible:!0,useLqip:!1,playerRef:p})}export{ee as a,Ze as b};
